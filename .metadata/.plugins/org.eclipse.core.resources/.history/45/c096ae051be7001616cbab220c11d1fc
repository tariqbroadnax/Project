package Editor.comp;

import java.awt.Canvas;

import Editor.EditorResources;
import Editor.SceneListener;
import Game.Game;
import Game.Scene;
import Game.Updater;
import Graphic.Camera;
import Graphic.Painter;

public class ScenePlayer extends Canvas
	implements SceneListener
{
	private EditorResources resources;
	
	private Updater updater;
	
	private Painter painter;
	
	private Game game;
	
	public ScenePlayer(EditorResources resources)
	{
		this.resources = resources;
		
		game = new Game();
				
		Camera camera = game.getCamera();
		
		painter = new Painter(this, camera);
	
		updater = new Updater();
		
		
		setIgnoreRepaint(true);
		
		updater.addUpdatable(d -> painter.paint());

		resources.addSceneListener(this);
	}

	private void start()
	{
		painter.clear();
		
		Scene scene = (Scene) resources.scene.clone();

		painter.addPaintable(scene);
		
		game.setScene(scene);
		
		updater.start();
		
		System.out.println("starting...");
	}
	
	private void stop()
	{
		updater.stop();
	
		System.out.println("stopping...");
	}
	
	@Override
	public void scenePlayerStarted() {
		start();
	}
	
	@Override
	public void scenePlayerStopped() {
		stop();
	}
}
