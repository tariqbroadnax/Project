package Ability;

import java.awt.geom.Point2D;

import Entity.Entity;
import Movement.Force;
import Movement.MovementComponent;

public class ProjectileAbility extends PointAbility
{
	private Entity projectile;

	private Force force;
	
	private double offset;
	
	public ProjectileAbility()
	{
		projectile = new Entity();
		
		force = new Force();
		
		offset = 5;
	}
	
	public void activate()
	{
		super.activate();	
		
		Point2D.Double src = getSrc().getLoc();
		
		double angle = Math.atan2(target.y - src.y, 
								  target.x - src.x);
		
		double x = src.x + Math.cos(angle) * offset,
			   y = src.y + Math.sin(angle) * offset;
		
		Force force = (Force) this.force.clone();
		
		force.setDirection(angle);
		
		Entity clone = (Entity) projectile.clone();
		
		clone.setLoc(x, y);
		
		if(clone.contains(MovementComponent.class))
			clone.get(MovementComponent.class)
				 .getMovement()
				 .addForce(force);
		
		this.src.getSceneLoc()
				.addEntity(clone);
	}
	
	public Entity getProjectile() {
		return projectile;
	}
}
